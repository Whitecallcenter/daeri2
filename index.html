<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ëŒ€ë¦¬ìš´ì „ í¬ì¸íŠ¸ ë¡œë˜</title>

<style>
html,body{margin:0;height:100%;background:#111;color:#fff;font-family:sans-serif}
.container{height:100vh;display:flex;flex-direction:column;justify-content:space-between;padding:20px}
h2{text-align:center}
.info{text-align:center;font-size:20px}

.machine{
  position:relative;
  width:220px;height:220px;
  margin:0 auto;
  border-radius:50%;
  background:#222;
  overflow:hidden;
}
.balls{
  position:absolute;inset:0;
  display:flex;flex-wrap:wrap;
  justify-content:center;align-items:center;
  animation:shake .3s infinite;
}
.ball{width:26px;height:26px;border-radius:50%;background:#ffcc00;margin:6px}
@keyframes shake{
  0%{transform:translate(0,0)}
  25%{transform:translate(2px,2px)}
  50%{transform:translate(-2px,-2px)}
  75%{transform:translate(2px,-2px)}
  100%{transform:translate(0,0)}
}
.exit{
  position:absolute;
  top:130px;left:50%;
  transform:translateX(-50%);
  width:60px;height:60px;
  border-radius:50%;
  background:#ffcc00;
  color:#000;font-weight:bold;
  display:none;align-items:center;justify-content:center;
}
.exit.show{display:flex;animation:pop 1s forwards}
@keyframes pop{
  0%{top:130px;opacity:0}
  50%{opacity:1}
  100%{top:-40px}
}

button{
  width:100%;padding:18px;font-size:18px;
  border:none;border-radius:12px;background:#ffcc00
}
input{
  width:100%;padding:14px;font-size:16px;
  border-radius:10px;border:none;margin-top:10px
}
.log{text-align:center;color:#ccc;min-height:40px}
.small{text-align:center;font-size:13px;color:#aaa}
.phone{text-align:center;margin-top:10px}
.phone a{color:#ffcc00;text-decoration:none}
</style>
</head>

<body>

<div class="container">

  <div>
    <h2>ğŸ° ëŒ€ë¦¬ìš´ì „ í¬ì¸íŠ¸ ë¡œë˜</h2>
    <div class="info">í¬ì¸íŠ¸: <span id="point">0</span>P</div>
    <div class="info">ë‚¨ì€ ê¸°íšŒ: <span id="chance">0</span>íšŒ</div>
  </div>

  <div>
    <div class="machine">
      <div class="balls" id="balls">
        <div class="ball"></div><div class="ball"></div><div class="ball"></div>
        <div class="ball"></div><div class="ball"></div><div class="ball"></div>
        <div class="ball"></div><div class="ball"></div><div class="ball"></div>
      </div>
      <div class="exit" id="exitBall"></div>
    </div>

    <button onclick="draw()">ê³µ ë½‘ê¸° ğŸ¯</button>
    <div class="log" id="log"></div>

    <hr style="border:1px solid #333;margin:20px 0">

    <h3>ğŸš– ê¸°ì‚¬ ì†Œê°œ</h3>
    <input id="phone" placeholder="010-0000-0000" maxlength="13">
    <button onclick="requestInvite()">ê¸°ì‚¬ ì†Œê°œ ìš”ì²­</button>
  </div>

  <div>
    <div class="phone">
      ğŸ“ ê¸°ì‚¬ ê°€ì… ë¬¸ì˜ <a href="tel:024700071">02-470-0071</a>
    </div>
    <div class="small">
      â€» ê¸°ì‚¬ ë“±ë¡ í™•ì¸ í›„ ê¸°íšŒ ì§€ê¸‰<br>
      10ë§ŒP ì´ìƒë¶€í„° ì¶©ì „ê¸ˆ ì „í™˜ ê°€ëŠ¥
    </div>
  </div>

</div>

<script>
// ---------- ì´ˆê¸° 1íšŒë§Œ ì§€ê¸‰ ----------
if(localStorage.getItem("init")!=="yes"){
  localStorage.setItem("point",0);
  localStorage.setItem("chance",6);
  localStorage.setItem("pending","[]");
  localStorage.setItem("approved","[]");
  localStorage.setItem("init","yes");
}

let point = Number(localStorage.getItem("point"));
let chance = Number(localStorage.getItem("chance"));
let pending = JSON.parse(localStorage.getItem("pending"));
let approved = JSON.parse(localStorage.getItem("approved"));

update();

// ---------- í•µì‹¬ ë³´ì • ë¡œì§ ----------
const TARGET_MIN = 80000;
const TARGET_MAX = 90000;

function getReward(){
  // ê¸°ë³¸ êµ¬ê°„ (ê¸°ì‚¬ ìŠ¹ì¸ 3ëª… ë¯¸ë§Œ)
  if(approved.length < 3){
    // ë§ˆì§€ë§‰ ê¸°ë³¸ ê¸°íšŒ â†’ ê°•ì œ ë³´ì •
    if(chance === 1){
      let min = Math.max(1000, TARGET_MIN - point);
      let max = Math.max(min, TARGET_MAX - point);
      return Math.floor(
        (Math.random()*(max-min)+min)/1000
      )*1000;
    }
    return pick([8000,9000,10000,12000,15000]);
  }
  // ê¸°ì‚¬ 3ëª… ì´ìƒ â†’ ê³ ì•¡ í’€
  return pick([10000,20000,30000]);
}

// ---------- ê³µ ë½‘ê¸° ----------
function draw(){
  if(chance<=0) return log("âŒ ê¸°íšŒ ì—†ìŒ");

  const balls=document.getElementById("balls");
  const exit=document.getElementById("exitBall");
  balls.style.animationPlayState="running";
  exit.classList.remove("show");

  setTimeout(()=>{
    balls.style.animationPlayState="paused";

    let reward = getReward();
    point += reward;
    chance--;

    exit.innerText = reward.toLocaleString()+"P";
    exit.classList.add("show");

    save(); update();
    log("ğŸ‰ ë‹¹ì²¨!");
  },2000);
}

// ---------- ê¸°ì‚¬ ì†Œê°œ ìš”ì²­ ----------
function requestInvite(){
  let phone=document.getElementById("phone").value.trim();
  let reg=/^010-\d{4}-\d{4}$/;
  if(!reg.test(phone)) return log("íœ´ëŒ€í° ë²ˆí˜¸ í˜•ì‹ í™•ì¸");
  if(pending.includes(phone)) return log("ì´ë¯¸ ìš”ì²­ë¨");

  pending.push(phone);
  save();
  log("ğŸ“Œ ê¸°ì‚¬ ë“±ë¡ í™•ì¸ ì¤‘ì…ë‹ˆë‹¤");
}

// ---------- (ê´€ë¦¬ììš© ìˆ˜ë™ ìŠ¹ì¸ ë°©ì‹) ----------
// ì‹¤ì œ ìš´ì˜ ì‹œ ì—¬ê¸° approved ë°°ì—´ì—
// ê°€ì… ì™„ë£Œëœ ë²ˆí˜¸ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì¶”ê°€
// ì˜ˆ: approved.push("010-1234-5678");

pending.forEach(p=>{
  if(approved.includes(p)){
    chance++;
    pending = pending.filter(x=>x!==p);
  }
});

// ---------- ê³µí†µ ----------
function pick(arr){return arr[Math.floor(Math.random()*arr.length)]}
function save(){
  localStorage.setItem("point",point);
  localStorage.setItem("chance",chance);
  localStorage.setItem("pending",JSON.stringify(pending));
  localStorage.setItem("approved",JSON.stringify(approved));
}
function update(){
  document.getElementById("point").innerText=point.toLocaleString();
  document.getElementById("chance").innerText=chance;
}
function log(msg){
  document.getElementById("log").innerText=msg;
}
</script>

</body>
</html>
